<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Australian Retirement Calculator</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
    <style>
        .input-with-icon {
            position: relative;
        }
        .input-icon {
            position: absolute;
            left: 8px;
            top: 50%;
            transform: translateY(-50%);
            color: #6B7280;
        }
        .input-with-icon input {
            padding-left: 2rem;
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen py-8">
    <div class="max-w-4xl mx-auto px-4">
        <div class="bg-white rounded-lg shadow-lg p-6">
            <h1 class="text-2xl font-bold mb-6">üê® Australian Retirement Calculator</h1>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- Input Section -->
                <div class="space-y-4">
                    <!-- Property Details -->
                    <div class="bg-blue-50 p-4 rounded-lg">
                        <h3 class="font-semibold mb-4">Property Details</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium mb-1">Current Home Value</label>
                                <div class="input-with-icon">
                                    <span class="input-icon">$</span>
                                    <input type="number" id="currentHomeValue" value="1500000" min="0" step="10000"
                                        class="w-full p-2 border rounded" />
                                </div>
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-1">Downsized Home Value</label>
                                <div class="input-with-icon">
                                    <span class="input-icon">$</span>
                                    <input type="number" id="newHomeValue" value="800000" min="0" step="10000"
                                        class="w-full p-2 border rounded" />
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Super Details -->
                    <div class="bg-green-50 p-4 rounded-lg">
                        <h3 class="font-semibold mb-4">Superannuation Details</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium mb-1">Current Super Balance</label>
                                <div class="input-with-icon">
                                    <span class="input-icon">$</span>
                                    <input type="number" id="currentSuper" value="600000" min="0" step="10000"
                                        class="w-full p-2 border rounded" />
                                </div>
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-1">Annual Salary (for Super)</label>
                                <div class="input-with-icon">
                                    <span class="input-icon">$</span>
                                    <input type="number" id="salaryForSuper" value="150000" min="0" step="1000"
                                        class="w-full p-2 border rounded" />
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Basic Info -->
                    <div>
                        <label class="block text-sm font-medium mb-1">Current Age</label>
                        <input type="number" id="currentAge" value="55" min="18" max="100"
                            class="w-full p-2 border rounded" />
                    </div>

                    <!-- Advanced Options Toggle -->
                    <button id="advancedToggle" class="text-blue-600 text-sm flex items-center gap-2">
                        <span class="toggle-icon">‚ñº</span>
                        Show Advanced Options
                    </button>

                    <!-- Advanced Options -->
                    <div id="advancedOptions" class="hidden space-y-4">
                        <div>
                            <label class="block text-sm font-medium mb-1">Current Non-Super Savings</label>
                            <div class="input-with-icon">
                                <span class="input-icon">$</span>
                                <input type="number" id="currentSavings" value="500000" min="0" step="10000"
                                    class="w-full p-2 border rounded" />
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1">Annual Living Expenses</label>
                            <div class="input-with-icon">
                                <span class="input-icon">$</span>
                                <input type="number" id="annualExpenses" value="80000" min="0" step="1000"
                                    class="w-full p-2 border rounded" />
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1">Expected Investment Return (%)</label>
                            <input type="number" id="expectedReturn" value="5" min="0" max="20" step="0.1"
                                class="w-full p-2 border rounded" />
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1">Super Return Rate (%)</label>
                            <input type="number" id="superReturnRate" value="7" min="0" max="20" step="0.1"
                                class="w-full p-2 border rounded" />
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1">Inflation Rate (%)</label>
                            <input type="number" id="inflationRate" value="2.5" min="0" max="10" step="0.1"
                                class="w-full p-2 border rounded" />
                        </div>
                    </div>
                </div>

                <!-- Results Section -->
                <div class="bg-gray-50 p-6 rounded-lg">
                    <h3 class="text-xl font-semibold mb-6">Your Retirement Journey</h3>
                    
                    <!-- Step 1: Downsizing Impact -->
                    <div class="bg-white p-4 rounded-lg shadow-sm mb-6">
                        <div class="flex items-center mb-3">
                            <span class="bg-green-100 text-green-800 font-semibold rounded-full w-6 h-6 flex items-center justify-center mr-2">1</span>
                            <h4 class="font-semibold text-green-800">Money Released from Downsizing</h4>
                        </div>
                        <p id="capitalFreed" class="text-3xl font-bold text-green-600 mb-2">$0</p>
                        <p class="text-sm text-gray-600">This is how much money you'll free up by downsizing your home. You can invest this amount to generate retirement income.</p>
                    </div>

                    <!-- Step 2: Monthly Income -->
                    <div class="bg-white p-4 rounded-lg shadow-sm mb-6">
                        <div class="flex items-center mb-3">
                            <span class="bg-blue-100 text-blue-800 font-semibold rounded-full w-6 h-6 flex items-center justify-center mr-2">2</span>
                            <h4 class="font-semibold text-blue-800">Your Monthly Retirement Income</h4>
                        </div>
                        <p id="monthlyIncome" class="text-3xl font-bold text-blue-600 mb-2">$0</p>
                        <p class="text-sm text-gray-600">This is your estimated monthly income in retirement, combining your super and investment returns.</p>
                    </div>

                    <!-- Step 3: Early Retirement Details -->
                    <div class="bg-white p-4 rounded-lg shadow-sm mb-6">
                        <div class="flex items-center mb-3">
                            <span class="bg-purple-100 text-purple-800 font-semibold rounded-full w-6 h-6 flex items-center justify-center mr-2">3</span>
                            <h4 class="font-semibold text-purple-800">Early Retirement Potential</h4>
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <p class="text-sm text-gray-600 mb-1">Years Earlier You Could Retire</p>
                                <p id="yearsEarlier" class="text-2xl font-bold text-purple-600">0 years</p>
                            </div>
                            <div>
                                <p class="text-sm text-gray-600 mb-1">Total Retirement Savings</p>
                                <p id="projectedSuper" class="text-2xl font-bold text-purple-600">$0</p>
                            </div>
                        </div>
                        <p class="text-sm text-gray-600 mt-2">This shows how many years earlier you could potentially retire compared to the traditional retirement age of 67.</p>
                    </div>

                    <!-- Summary Box -->
                    <div class="bg-blue-50 p-4 rounded-lg border border-blue-100">
                        <h4 class="font-semibold text-blue-800 mb-3">What This Means For You:</h4>
                        <div id="insights" class="space-y-3 text-sm text-blue-800"></div>
                    </div>

                    <!-- Disclaimer -->
                    <p class="text-xs text-gray-500 mt-4">
                        Note: These calculations are estimates based on current inputs and market assumptions. Actual results may vary. Consider consulting a financial advisor for personalized advice.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Constants
        const CONSTANTS = {
            TRADITIONAL_RETIREMENT_AGE: 67,
            SUPER_CONTRIBUTION_CAP: 27500,
            SAFE_WITHDRAWAL_RATE: 0.04,
            SUPER_PRESERVATION_AGE: 60,
            ASSET_TEST_THRESHOLD: 585750,
            BASE_PENSION_AMOUNT: 25000,
        };

        // Format currency
        function formatCurrency(value) {
            return new Intl.NumberFormat('en-AU', {
                style: 'currency',
                currency: 'AUD',
                maximumFractionDigits: 0,
            }).format(value);
        }

        // Get all input elements
        const inputs = document.querySelectorAll('input');
        const advancedToggle = document.getElementById('advancedToggle');
        const advancedOptions = document.getElementById('advancedOptions');

        // Get result elements
        const resultElements = {
            capitalFreed: document.getElementById('capitalFreed'),
            monthlyIncome: document.getElementById('monthlyIncome'),
            projectedSuper: document.getElementById('projectedSuper'),
            yearsEarlier: document.getElementById('yearsEarlier'),
            combinedWealth: document.getElementById('combinedWealth'),
            insights: document.getElementById('insights')
        };

        // Toggle advanced options
        advancedToggle.addEventListener('click', () => {
            const isHidden = advancedOptions.classList.contains('hidden');
            advancedOptions.classList.toggle('hidden');
            advancedToggle.innerHTML = `
                <span class="toggle-icon">${isHidden ? '‚ñ≤' : '‚ñº'}</span>
                ${isHidden ? 'Hide Advanced Options' : 'Show Advanced Options'}
            `;
        });

        // Get form data
        function getFormData() {
            return {
                currentHomeValue: parseFloat(document.getElementById('currentHomeValue').value) || 0,
                newHomeValue: parseFloat(document.getElementById('newHomeValue').value) || 0,
                currentSuper: parseFloat(document.getElementById('currentSuper').value) || 0,
                salaryForSuper: parseFloat(document.getElementById('salaryForSuper').value) || 0,
                currentAge: parseFloat(document.getElementById('currentAge').value) || 0,
                currentSavings: parseFloat(document.getElementById('currentSavings').value) || 0,
                annualExpenses: parseFloat(document.getElementById('annualExpenses').value) || 0,
                expectedReturn: parseFloat(document.getElementById('expectedReturn').value) || 0,
                superReturnRate: parseFloat(document.getElementById('superReturnRate').value) || 0,
                inflationRate: parseFloat(document.getElementById('inflationRate').value) || 0,
            };
        }

        // Calculate retirement projections
        function calculateRetirement() {
            const formData = getFormData();
            
            // Calculate capital freed from downsizing
            const capitalFreed = Math.max(0, formData.currentHomeValue - formData.newHomeValue);
            const totalInvestableCapital = capitalFreed + formData.currentSavings;
            
            // Calculate years to traditional retirement
            const yearsToTraditionalRetirement = Math.max(0, CONSTANTS.TRADITIONAL_RETIREMENT_AGE - formData.currentAge);
            
            // Super calculations
            const annualSuperContribution = Math.min(
                CONSTANTS.SUPER_CONTRIBUTION_CAP,
                formData.salaryForSuper * 0.115
            );
            
            // Account for inflation in returns
            const realInvestmentReturn = Math.max(0, (formData.expectedReturn - formData.inflationRate) / 100);
            const realSuperReturn = Math.max(0, (formData.superReturnRate - formData.inflationRate) / 100);
            
            // Early retirement calculations
            let yearsToRetirement = 0;
            let investedCapital = totalInvestableCapital;
            let currentSuper = formData.currentSuper;
            
            // Calculate retirement readiness
            function calculateRetirementReadiness(capital, superBalance, age) {
                const canAccessSuper = age >= CONSTANTS.SUPER_PRESERVATION_AGE;
                const incomeFromCapital = capital * CONSTANTS.SAFE_WITHDRAWAL_RATE;
                const incomeFromSuper = canAccessSuper ? superBalance * CONSTANTS.SAFE_WITHDRAWAL_RATE : 0;
                let estimatedAgePension = 0;
                
                if ((capital + superBalance) < CONSTANTS.ASSET_TEST_THRESHOLD) {
                    estimatedAgePension = CONSTANTS.BASE_PENSION_AMOUNT;
                }
                
                return (incomeFromCapital + incomeFromSuper + estimatedAgePension) >= formData.annualExpenses;
            }
            
            // Find earliest retirement point
            while (yearsToRetirement < yearsToTraditionalRetirement) {
                const projectedAge = formData.currentAge + yearsToRetirement;
                
                if (calculateRetirementReadiness(investedCapital, currentSuper, projectedAge)) {
                    break;
                }
                
                investedCapital *= (1 + realInvestmentReturn);
                currentSuper = (currentSuper + annualSuperContribution) * (1 + realSuperReturn);
                yearsToRetirement++;
                
                if (yearsToRetirement >= 50) break;
            }
            
            // Calculate final values
            const projectedSuper = formData.currentSuper * 
                Math.pow(1 + realSuperReturn, yearsToTraditionalRetirement) +
                annualSuperContribution * 
                ((Math.pow(1 + realSuperReturn, yearsToTraditionalRetirement) - 1) / realSuperReturn);

            const retirementAge = formData.currentAge + yearsToRetirement;
            const canAccessSuper = retirementAge >= CONSTANTS.SUPER_PRESERVATION_AGE;
            const monthlyIncomeFromCapital = (investedCapital * CONSTANTS.SAFE_WITHDRAWAL_RATE) / 12;
            const monthlyIncomeFromSuper = canAccessSuper ? (currentSuper * CONSTANTS.SAFE_WITHDRAWAL_RATE) / 12 : 0;
            const monthlyIncome = monthlyIncomeFromCapital + monthlyIncomeFromSuper;
            const yearsEarlier = Math.max(0, yearsToTraditionalRetirement - yearsToRetirement);
            const combinedWealth = currentSuper + investedCapital;

            // Update results in DOM
            resultElements.capitalFreed.textContent = formatCurrency(capitalFreed);
            resultElements.monthlyIncome.textContent = formatCurrency(monthlyIncome);
            resultElements.projectedSuper.textContent = formatCurrency(projectedSuper);
            resultElements.yearsEarlier.textContent = yearsEarlier.toFixed(1) + ' years';
            resultElements.combinedWealth.textContent = formatCurrency(combinedWealth);

            // Update insights
            const insights = [
                `Downsizing Impact: By downsizing from ${formatCurrency(formData.currentHomeValue)} to ${formatCurrency(formData.newHomeValue)}, you free up ${formatCurrency(capitalFreed)} to invest.`,
                `Investment Growth: This freed-up capital could generate approximately ${formatCurrency(capitalFreed * CONSTANTS.SAFE_WITHDRAWAL_RATE)} in annual passive income (using the 4% rule).`,
                `Super Growth: Your super could grow from ${formatCurrency(formData.currentSuper)} to ${formatCurrency(currentSuper)} by your early retirement date (age ${Math.round(retirementAge)}).`,
                `Monthly Income: At retirement, you could have ${formatCurrency(monthlyIncome)} monthly income from your combined super${canAccessSuper ? '' : ' (when accessible)'} and investment sources.`
            ];

            resultElements.insights.innerHTML = insights.map((insight, index) => `
                <p>${index + 1}. ${insight}</p>
            `).join('');
        }

        // Add event listeners to all inputs
        inputs.forEach(input => {
            input.addEventListener('input', calculateRetirement);
        });

        // Initial calculation
        calculateRetirement();
    </script>
</body>
</html>
